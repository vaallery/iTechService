/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
!function(){function e(e){var t=e.getStyle("overflow-y"),a=e.getDocument(),i=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"</span>",a);a[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(i);var n=i.getDocumentPosition(a).y+i.$.offsetHeight;return i.remove(),e.setStyle("overflow-y",t),n}var t=function(t){if(t.window){var a=t.document,i=(new CKEDITOR.dom.element(a.getWindow().$.frameElement),a.getBody()),n=a.getDocumentElement(),o=t.window.getViewPaneSize().height,r="BackCompat"==a.$.compatMode?i:n,s=e(r);s+=t.config.autoGrow_bottomSpace||0;var l=void 0!=t.config.autoGrow_minHeight?t.config.autoGrow_minHeight:200,d=t.config.autoGrow_maxHeight||1/0;s=Math.max(s,l),s=Math.min(s,d),s!=o&&(s=t.fire("autoGrow",{currentHeight:o,newHeight:s}).newHeight,t.resize(t.container.getStyle("width"),s,!0)),r.$.scrollHeight>r.$.clientHeight&&d>s?r.setStyle("overflow-y","hidden"):r.removeStyle("overflow-y")}};CKEDITOR.plugins.add("autogrow",{init:function(e){e.addCommand("autogrow",{exec:t,modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var a={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1};e.config.autoGrow_onStartup&&(a.instanceReady=1);for(var i in a)e.on(i,function(a){var i=e.getCommand("maximize");"wysiwyg"!=a.editor.mode||i&&i.state==CKEDITOR.TRISTATE_ON||setTimeout(function(){t(a.editor),t(a.editor)},100)})}})}();